<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Protocoles Extraordinaires | Fanal Academy</title>
    <link rel="stylesheet" href="quiz-styles.css">
    <style>
        :root {
            --quiz-primary: #dc3545;
            --quiz-secondary: #070143;
        }
        .quiz-header {
            background: linear-gradient(135deg, var(--quiz-primary) 0%, #a71d2a 100%);
        }
        .quiz-btn.selected {
            background-color: var(--quiz-primary);
            border-color: var(--quiz-primary);
        }
        .quiz-progress-bar {
            background-color: var(--quiz-primary);
        }
        .quiz-next-btn, .quiz-submit-btn, .quiz-restart-btn {
            background-color: var(--quiz-primary);
        }
        .quiz-next-btn:hover, .quiz-submit-btn:hover, .quiz-restart-btn:hover {
            background-color: #a71d2a;
        }
        .quiz-result-score.excellent { color: #28a745; }
        .quiz-result-score.good { color: var(--quiz-primary); }
        .quiz-result-score.average { color: #ffc107; }
        .quiz-result-score.poor { color: #dc3545; }
        .warning-badge {
            display: inline-block;
            background: #dc3545;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <!-- Header -->
        <div class="quiz-header">
            <a href="index.html" class="quiz-back-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Retour à Fanal Academy
            </a>
            <h1 class="quiz-title">Quiz Protocoles Extraordinaires</h1>
            <p class="quiz-subtitle">Gestion des infections et situations d'urgence sanitaire</p>
        </div>

        <!-- Main Content -->
        <div class="quiz-content">
            <!-- Introduction -->
            <div class="quiz-intro" id="quizIntro">
                <div class="quiz-intro-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#dc3545" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                        <line x1="12" y1="9" x2="12" y2="13"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                </div>
                <h2 class="quiz-intro-title">Protocoles d'Urgence Sanitaire</h2>
                <p class="quiz-intro-text">
                    Ce quiz teste vos connaissances sur les protocoles extraordinaires en cas d'infection :
                    Giardia, Typhus, Teigne, Gale et Puces. Ces situations nécessitent des mesures spécifiques
                    et une vigilance accrue pour protéger tous les chats du refuge.
                </p>
                <div class="quiz-intro-details">
                    <div class="quiz-detail-item">
                        <span class="quiz-detail-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                                <line x1="12" y1="17" x2="12.01" y2="17"/>
                            </svg>
                        </span>
                        <span class="quiz-detail-text">15 questions</span>
                    </div>
                    <div class="quiz-detail-item">
                        <span class="quiz-detail-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </span>
                        <span class="quiz-detail-text">5 minutes</span>
                    </div>
                    <div class="quiz-detail-item">
                        <span class="quiz-detail-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                            </svg>
                        </span>
                        <span class="quiz-detail-text">Niveau Avancé</span>
                    </div>
                </div>
                <button class="quiz-start-btn" id="startQuiz">
                    Commencer le Quiz
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>

            <!-- Quiz Form -->
            <form class="quiz-form" id="quizForm" style="display: none;">
                <div class="quiz-progress">
                    <div class="quiz-progress-bar" id="progressBar" style="width: 0%"></div>
                </div>
                <div class="quiz-timer" id="quizTimer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span id="timerDisplay">5:00</span>
                </div>

                <!-- Questions will be dynamically inserted here -->
                <div id="questionsContainer"></div>

                <div class="quiz-navigation">
                    <button type="button" class="quiz-prev-btn" id="prevBtn" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                        Précédent
                    </button>
                    <button type="button" class="quiz-next-btn" id="nextBtn">
                        Suivant
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"/>
                        </svg>
                    </button>
                    <button type="submit" class="quiz-submit-btn" id="submitBtn" style="display: none;">
                        Terminer le Quiz
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                            <polyline points="22 4 12 14.01 9 11.01"/>
                        </svg>
                    </button>
                </div>
            </form>

            <!-- Loading Screen -->
            <div class="quiz-loading" id="quizLoading" style="display: none;">
                <div class="quiz-loading-spinner"></div>
                <p class="quiz-loading-text">Analyse de vos réponses...</p>
            </div>

            <!-- Results -->
            <div class="quiz-results" id="quizResults" style="display: none;">
                <div class="quiz-result-header">
                    <div class="quiz-result-icon" id="resultIcon"></div>
                    <h2 class="quiz-result-title" id="resultTitle"></h2>
                    <p class="quiz-result-score" id="resultScore"></p>
                </div>
                <div class="quiz-result-details" id="resultDetails"></div>
                <div class="quiz-result-actions">
                    <button class="quiz-restart-btn" id="restartQuiz">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M2.5 2v6h6M21.5 22v-6h-6"/>
                            <path d="M22 11.5A10 10 0 0 0 3.2 7.2M2 12.5a10 10 0 0 0 18.8 4.2"/>
                        </svg>
                        Recommencer
                    </button>
                    <a href="index.html" class="quiz-home-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9 22 9 12 15 12 15 22"/>
                        </svg>
                        Retour à l'accueil
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        const QUESTIONS_DATA = {
            1: {
                question: "Quel produit désinfectant est utilisé pour la majorité des infections au refuge (Giardia, Teigne, Gale) ?",
                answers: {
                    a: "Le Dettol, utilisé pour le nettoyage quotidien",
                    b: "L'eau de Javel, efficace contre tous les pathogènes",
                    c: "Le C.I.D.20, spécifiquement formulé contre parasites et champignons",
                    d: "L'alcool 70° avec temps de contact prolongé"
                },
                correct: "c",
                explanation: "Le C.I.D.20 est le désinfectant de référence pour la plupart des infections (Giardia, Teigne, Gale, Puces). Il est efficace contre les parasites et champignons tout en étant compatible avec les surfaces du refuge."
            },
            2: {
                question: "Pour quelle infection spécifique utilise-t-on l'eau de Javel comme désinfectant principal ?",
                answers: {
                    a: "La Teigne, car les spores fongiques y sont sensibles",
                    b: "La Gale, car les acariens ne résistent pas au chlore",
                    c: "La Giardia, car les kystes sont détruits par le chlore",
                    d: "Le Typhus (Panleucopénie féline), seul cas où la Javel est nécessaire"
                },
                correct: "d",
                explanation: "Le Typhus (Panleucopénie féline) est causé par un parvovirus extrêmement résistant. Seule l'eau de Javel à concentration appropriée peut l'éliminer efficacement. C'est la seule exception où la Javel est le produit de choix."
            },
            3: {
                question: "Quelle est la première action à effectuer lors de la découverte d'un cas suspect d'infection contagieuse ?",
                answers: {
                    a: "Isoler immédiatement l'animal et alerter le responsable",
                    b: "Nettoyer et désinfecter la zone avant toute chose",
                    c: "Administrer un traitement préventif aux autres chats",
                    d: "Attendre la confirmation du vétérinaire avant d'agir"
                },
                correct: "a",
                explanation: "L'isolement immédiat de l'animal suspect et l'alerte du responsable sont prioritaires. Cela permet de limiter la propagation et d'organiser une réponse appropriée avant toute autre action."
            },
            4: {
                question: "La Giardia est causée par :",
                answers: {
                    a: "Un virus très contagieux par voie aérienne",
                    b: "Une bactérie intestinale opportuniste",
                    c: "Un champignon dermatophyte",
                    d: "Un parasite protozoaire unicellulaire"
                },
                correct: "d",
                explanation: "La Giardia est une infection causée par Giardia duodenalis, un parasite protozoaire qui affecte le système digestif. Elle se transmet par voie oro-fécale et peut contaminer l'environnement."
            },
            5: {
                question: "Quel est le principal symptôme de la Giardia chez le chat ?",
                answers: {
                    a: "Perte de poils en plaques circulaires",
                    b: "Démangeaisons intenses sur tout le corps",
                    c: "Diarrhée chronique et malodorante",
                    d: "Fièvre élevée et abattement sévère"
                },
                correct: "c",
                explanation: "La Giardia provoque principalement des troubles digestifs : diarrhée chronique, souvent malodorante, parfois avec du mucus. Les selles peuvent être molles ou liquides."
            },
            6: {
                question: "La Teigne est une infection causée par :",
                answers: {
                    a: "Un champignon dermatophyte (Microsporum canis)",
                    b: "Un ver parasite qui vit sous la peau",
                    c: "Un acarien microscopique",
                    d: "Une bactérie cutanée"
                },
                correct: "a",
                explanation: "Malgré son nom, la Teigne n'est pas causée par un ver mais par des champignons dermatophytes (Microsporum canis principalement). Elle est très contagieuse, y compris pour l'homme (zoonose)."
            },
            7: {
                question: "Quel équipement de protection est OBLIGATOIRE lors de la manipulation d'un chat atteint de Teigne ?",
                answers: {
                    a: "Uniquement des gants jetables",
                    b: "Un masque FFP2 suffit car transmission aérienne",
                    c: "Gants + blouse jetable + charlotte (protection complète)",
                    d: "Aucun équipement si on se lave les mains après"
                },
                correct: "c",
                explanation: "La Teigne étant une zoonose (transmissible à l'homme) et très contagieuse, il faut porter des gants, une blouse jetable et une charlotte pour éviter tout contact avec les spores fongiques qui peuvent rester sur les vêtements et cheveux."
            },
            8: {
                question: "Quelle est la particularité du virus du Typhus concernant sa résistance dans l'environnement ?",
                answers: {
                    a: "Il meurt en quelques heures à l'air libre",
                    b: "Il ne survit que sur les surfaces humides",
                    c: "Il est facilement détruit par le savon ordinaire",
                    d: "Il peut survivre plusieurs mois à température ambiante"
                },
                correct: "d",
                explanation: "Le parvovirus du Typhus est extrêmement résistant : il peut survivre plusieurs mois (jusqu'à 1 an) dans l'environnement à température ambiante. C'est pourquoi la désinfection à la Javel est indispensable."
            },
            9: {
                question: "La Gale du chat est provoquée par :",
                answers: {
                    a: "Un champignon qui attaque la peau",
                    b: "Un acarien (Notoedres cati) qui creuse des galeries",
                    c: "Un virus cutané très contagieux",
                    d: "Une bactérie responsable de lésions croûteuses"
                },
                correct: "b",
                explanation: "La gale du chat (gale notoédrique) est causée par l'acarien Notoedres cati qui creuse des galeries dans la peau, provoquant des démangeaisons intenses et des lésions croûteuses, principalement sur la tête."
            },
            10: {
                question: "Lors d'une épidémie de Typhus, quelle zone doit être désinfectée en PREMIER ?",
                answers: {
                    a: "La zone d'isolement/quarantaine où se trouve l'animal infecté",
                    b: "Les zones collectives pour protéger les autres chats",
                    c: "L'extérieur car le virus vient de là",
                    d: "Les boxes d'accueil des nouveaux arrivants"
                },
                correct: "a",
                explanation: "En cas de Typhus, la zone d'isolement (code rouge) où se trouve l'animal infecté doit être désinfectée en premier et de manière la plus rigoureuse pour contenir l'infection avant qu'elle ne se propage."
            },
            11: {
                question: "Quelle est la concentration recommandée pour l'eau de Javel contre le Typhus ?",
                answers: {
                    a: "Pure, non diluée pour une efficacité maximale",
                    b: "1:10 (1 part Javel pour 10 parts eau)",
                    c: "1:32 (1 part Javel pour 32 parts eau, soit ~3% chlore actif)",
                    d: "1:100 (1 part Javel pour 100 parts eau)"
                },
                correct: "c",
                explanation: "Pour le Typhus, la Javel doit être diluée à 1:32 (environ 3% de chlore actif). Cette concentration est efficace contre le parvovirus tout en restant utilisable sur les surfaces. Un temps de contact de 10 minutes minimum est nécessaire."
            },
            12: {
                question: "Pourquoi les puces représentent-elles un danger pour la santé des chats au-delà des démangeaisons ?",
                answers: {
                    a: "Elles peuvent transmettre le ténia et causer une anémie sévère",
                    b: "Elles causent uniquement des allergies cutanées",
                    c: "Elles ne sont dangereuses que pour les humains",
                    d: "Elles provoquent des problèmes respiratoires"
                },
                correct: "a",
                explanation: "Les puces sont vectrices du ténia (Dipylidium caninum) et peuvent provoquer une anémie sévère chez les chatons ou chats affaiblis par leurs piqûres répétées. Elles peuvent aussi transmettre d'autres maladies."
            },
            13: {
                question: "Combien de temps faut-il maintenir un chat en isolement après un traitement contre la Teigne ?",
                answers: {
                    a: "1 semaine après le début du traitement",
                    b: "24 heures après la fin du traitement",
                    c: "3 jours après disparition des symptômes visibles",
                    d: "Jusqu'à 2 cultures fongiques négatives consécutives"
                },
                correct: "d",
                explanation: "Pour la Teigne, l'isolement doit être maintenu jusqu'à obtention de 2 cultures fongiques négatives consécutives (généralement à 1-2 semaines d'intervalle). La disparition des symptômes visibles ne signifie pas la fin de la contagiosité."
            },
            14: {
                question: "Quel est l'ordre correct de nettoyage des zones lors d'une infection déclarée ?",
                answers: {
                    a: "Zone infectée → Zones saines → Extérieur",
                    b: "Zones saines → Zone infectée → Extérieur (du propre au sale)",
                    c: "Extérieur → Zone infectée → Zones saines",
                    d: "Toutes les zones en même temps pour gagner du temps"
                },
                correct: "b",
                explanation: "On nettoie toujours du plus propre vers le plus sale : d'abord les zones saines pour les protéger, puis la zone infectée en dernier pour éviter de propager les agents pathogènes. L'extérieur est généralement moins prioritaire."
            },
            15: {
                question: "Que doit-on faire du matériel utilisé pour un chat en quarantaine infection ?",
                answers: {
                    a: "Le laver normalement avec les autres équipements",
                    b: "Le jeter systématiquement après chaque utilisation",
                    c: "Le dédier exclusivement à ce chat et le désinfecter après chaque usage",
                    d: "Le rincer à l'eau claire entre chaque utilisation"
                },
                correct: "c",
                explanation: "Le matériel (gamelles, litière, jouets) doit être dédié exclusivement à l'animal en quarantaine pour éviter la contamination croisée. Il doit être désinfecté après chaque usage avec le produit approprié (C.I.D.20 ou Javel selon l'infection)."
            }
        };

        $(document).ready(function() {
            let currentStep = 1;
            const totalSteps = Object.keys(QUESTIONS_DATA).length;
            let timerInterval;
            let timeRemaining = 300; // 5 minutes
            let userAnswers = {};

            // Generate question HTML
            function generateQuestions() {
                let html = '';
                for (let i = 1; i <= totalSteps; i++) {
                    const q = QUESTIONS_DATA[i];
                    html += `
                        <fieldset class="quiz-step" id="step${i}" style="display: ${i === 1 ? 'block' : 'none'};">
                            <div class="quiz-question-header">
                                <span class="quiz-question-number">Question ${i}/${totalSteps}</span>
                            </div>
                            <h3 class="quiz-question-title">${q.question}</h3>
                            <div class="quiz-options">
                                ${Object.entries(q.answers).map(([key, value]) => `
                                    <button type="button" class="quiz-btn" data-question="${i}" data-answer="${key}">
                                        <span class="quiz-btn-letter">${key.toUpperCase()}</span>
                                        <span class="quiz-btn-text">${value}</span>
                                    </button>
                                `).join('')}
                            </div>
                            <div class="quiz-error" id="error${i}" style="display: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="12" y1="8" x2="12" y2="12"/>
                                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                                </svg>
                                Veuillez sélectionner une réponse
                            </div>
                        </fieldset>
                    `;
                }
                $('#questionsContainer').html(html);
            }

            // Start quiz
            $('#startQuiz').click(function() {
                $('#quizIntro').hide();
                $('#quizForm').show();
                generateQuestions();
                startTimer();
            });

            // Timer
            function startTimer() {
                updateTimerDisplay();
                timerInterval = setInterval(function() {
                    timeRemaining--;
                    updateTimerDisplay();
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        submitQuiz();
                    }
                }, 1000);
            }

            function updateTimerDisplay() {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                $('#timerDisplay').text(`${minutes}:${seconds.toString().padStart(2, '0')}`);
                if (timeRemaining <= 60) {
                    $('#quizTimer').css('color', '#dc3545');
                }
            }

            // Answer selection
            $(document).on('click', '.quiz-btn', function() {
                const question = $(this).data('question');
                const answer = $(this).data('answer');

                $(`[data-question="${question}"]`).removeClass('selected');
                $(this).addClass('selected');
                userAnswers[question] = answer;
                $(`#error${question}`).hide();
            });

            // Navigation
            $('#nextBtn').click(function() {
                if (!userAnswers[currentStep]) {
                    $(`#error${currentStep}`).show();
                    return;
                }

                if (currentStep < totalSteps) {
                    $(`#step${currentStep}`).hide();
                    currentStep++;
                    $(`#step${currentStep}`).show();
                    updateProgress();
                    updateNavigation();
                }
            });

            $('#prevBtn').click(function() {
                if (currentStep > 1) {
                    $(`#step${currentStep}`).hide();
                    currentStep--;
                    $(`#step${currentStep}`).show();
                    updateProgress();
                    updateNavigation();
                }
            });

            function updateProgress() {
                const progress = (currentStep / totalSteps) * 100;
                $('#progressBar').css('width', progress + '%');
            }

            function updateNavigation() {
                $('#prevBtn').toggle(currentStep > 1);
                $('#nextBtn').toggle(currentStep < totalSteps);
                $('#submitBtn').toggle(currentStep === totalSteps);
            }

            // Submit
            $('#quizForm').submit(function(e) {
                e.preventDefault();
                if (!userAnswers[currentStep]) {
                    $(`#error${currentStep}`).show();
                    return;
                }
                submitQuiz();
            });

            function submitQuiz() {
                clearInterval(timerInterval);
                $('#quizForm').hide();
                $('#quizLoading').show();

                setTimeout(function() {
                    showResults();
                }, 1500);
            }

            function showResults() {
                $('#quizLoading').hide();
                $('#quizResults').show();

                let correctCount = 0;
                let detailsHtml = '';

                for (let i = 1; i <= totalSteps; i++) {
                    const q = QUESTIONS_DATA[i];
                    const userAnswer = userAnswers[i] || 'Non répondu';
                    const isCorrect = userAnswer === q.correct;
                    if (isCorrect) correctCount++;

                    detailsHtml += `
                        <div class="quiz-result-item ${isCorrect ? 'correct' : 'incorrect'}">
                            <div class="quiz-result-item-header">
                                <span class="quiz-result-item-number">Q${i}</span>
                                <span class="quiz-result-item-status">
                                    ${isCorrect ?
                                        '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#28a745" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>' :
                                        '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#dc3545" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>'
                                    }
                                </span>
                            </div>
                            <p class="quiz-result-item-question">${q.question}</p>
                            <p class="quiz-result-item-answer">
                                Votre réponse : <strong>${userAnswer !== 'Non répondu' ? q.answers[userAnswer] : 'Non répondu'}</strong>
                                ${!isCorrect ? `<br>Bonne réponse : <strong class="correct-answer">${q.answers[q.correct]}</strong>` : ''}
                            </p>
                            <p class="quiz-result-item-explanation">${q.explanation}</p>
                        </div>
                    `;
                }

                const percentage = Math.round((correctCount / totalSteps) * 100);
                let title, scoreClass, icon;

                if (percentage >= 90) {
                    title = "Expert en protocoles d'urgence !";
                    scoreClass = "excellent";
                    icon = '<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#28a745" stroke-width="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>';
                } else if (percentage >= 70) {
                    title = "Bonnes connaissances des protocoles";
                    scoreClass = "good";
                    icon = '<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#dc3545" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>';
                } else if (percentage >= 50) {
                    title = "Quelques révisions nécessaires";
                    scoreClass = "average";
                    icon = '<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#ffc107" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>';
                } else {
                    title = "Formation complémentaire requise";
                    scoreClass = "poor";
                    icon = '<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#dc3545" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>';
                }

                $('#resultIcon').html(icon);
                $('#resultTitle').text(title);
                $('#resultScore').html(`<span class="${scoreClass}">${correctCount}/${totalSteps}</span> (${percentage}%)`);
                $('#resultDetails').html(detailsHtml);
            }

            // Restart
            $('#restartQuiz').click(function() {
                currentStep = 1;
                timeRemaining = 300;
                userAnswers = {};
                $('#quizResults').hide();
                $('#quizIntro').show();
                $('#progressBar').css('width', '0%');
                $('#quizTimer').css('color', '');
            });
        });
    </script>
</body>
</html>
